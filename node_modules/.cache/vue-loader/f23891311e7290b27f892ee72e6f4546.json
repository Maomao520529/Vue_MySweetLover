{"remainingRequest":"D:\\作品集\\Vue_MySweetLover\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\作品集\\Vue_MySweetLover\\src\\views\\backEnd\\ProductsList.vue?vue&type=style&index=0&id=0bd1f692&lang=scss&scoped=true&","dependencies":[{"path":"D:\\作品集\\Vue_MySweetLover\\src\\views\\backEnd\\ProductsList.vue","mtime":1583938825628},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgp0ZXh0YXJlYSB7CiAgcmVzaXplIDogbm9uZTsKfQo="},{"version":3,"sources":["ProductsList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0WA;AACA;AACA","file":"ProductsList.vue","sourceRoot":"src/views/backEnd","sourcesContent":["<template>\n  <div class=\"products\">\n    <loading :active.sync=\"isLoading\">\n      <img src=\"../../assets/images/load.gif\" alt=\"loading\">\n      <!-- <Circle4></Circle4> -->\n    </loading>\n\n    <div class=\"text-right mb-4\">\n      <button class=\"btn btn-outline-primary\" @click.prevent=\"openProductModal(true)\">\n        <i class=\"fas fa-plus mr-2\"></i>新增產品\n      </button>\n    </div>\n    <table class=\"table table-hover\">\n      <thead>\n        <tr>\n          <th class=\"text-left\" width=\"120\">分類</th>\n          <th class=\"text-left\">產品名稱</th>\n          <th class=\"text-center\" width=\"100\">原價</th>\n          <th class=\"text-center\" width=\"100\">網路價</th>\n          <th class=\"text-center\" width=\"100\">是否販售</th>\n          <th class=\"text-center\" width=\"150\">編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in products\" :key=\"item.id\">\n          <td class=\"text-left\">{{ item.category }}</td>\n          <td class=\"text-left\">{{ item.title }}</td>\n          <td class=\"text-right\">{{ item.origin_price | currency }}</td>\n          <td class=\"text-right\">{{ item.price | currency }}</td>\n          <td class=\"text-center\">\n            <span v-if=\"item.is_enabled\" class=\"text-success\">啟用</span>\n            <span v-else>未啟用</span>\n          </td>\n          <td class=\"text-center\">\n            <div class=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\n              <button\n                type=\"button\"\n                class=\"btn btn-outline-primary\"\n                @click.prevent=\"openProductModal(false, item)\"\n              >\n                <i class=\"fas fa-pencil-alt\"></i>\n              </button>\n              <button\n                type=\"button\"\n                class=\"btn btn-outline-orange\"\n                @click.prevent=\"delModal(item)\"\n              >\n                <i class=\"fas fa-trash-alt\"></i>\n              </button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <!-- Start Pagination -->\n    <div class=\"d-flex justify-content-center\">\n      <Pagination :pages=\"pagination\" @emitPages=\"getProducts\"></Pagination>\n    </div>\n    <!-- End Pagination -->\n\n    <!-- Start ProductModal -->\n    <div\n      class=\"modal fade\"\n      id=\"productModal\"\n      tabindex=\"-1\"\n      role=\"dialog\"\n      aria-labelledby=\"productModalLabel\"\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog modal-lg\" role=\"document\">\n        <div class=\"modal-content border-0\">\n          <div class=\"modal-header bg-primary text-white\">\n            <h5 class=\"modal-title editModalTitle\" id=\"productModalLabel\">\n              <span>編輯產品</span>\n            </h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <i class=\"far fa-times-circle text-white\" aria-hidden=\"true\"></i>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            <div class=\"row\">\n              <div class=\"col-sm-4\">\n                <div class=\"form-group\">\n                  <label for=\"image\">輸入圖片網址</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"image\"\n                    placeholder=\"請輸入圖片連結\"\n                    v-model=\"tempProduct.imageUrl\"\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"customFile\">\n                    或 上傳圖片\n                    <i class=\"fas fa-spinner fa-spin\" v-if=\"status.fileUploading\"></i>\n                  </label>\n                  <input\n                    type=\"file\"\n                    id=\"customFile\"\n                    class=\"form-control\"\n                    ref=\"files\"\n                    @change=\"uploadFile\"\n                  />\n                </div>\n                <img\n                  img=\"https://images.unsplash.com/photo-1483985988355-763728e1935b?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=828346ed697837ce808cae68d3ddc3cf&auto=format&fit=crop&w=1350&q=80\"\n                  class=\"img-fluid\"\n                  alt\n                  :src=\"tempProduct.imageUrl\"\n                />\n              </div>\n              <div class=\"col-sm-8\">\n                <div class=\"form-group\">\n                  <label for=\"title\">標題</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"title\"\n                    placeholder=\"請輸入標題\"\n                    v-model=\"tempProduct.title\"\n                  />\n                </div>\n\n                <div class=\"form-row\">\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"category\">分類</label>\n                    <input\n                      type=\"text\"\n                      class=\"form-control\"\n                      id=\"category\"\n                      placeholder=\"請輸入分類\"\n                      v-model=\"tempProduct.category\"\n                    />\n                  </div>\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"price\">單位</label>\n                    <input\n                      type=\"unit\"\n                      class=\"form-control\"\n                      id=\"unit\"\n                      placeholder=\"請輸入單位\"\n                      v-model=\"tempProduct.unit\"\n                    />\n                  </div>\n                </div>\n\n                <div class=\"form-row\">\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"origin_price\">原價</label>\n                    <input\n                      type=\"number\"\n                      class=\"form-control\"\n                      id=\"origin_price\"\n                      placeholder=\"請輸入原價\"\n                      v-model=\"tempProduct.origin_price\"\n                    />\n                  </div>\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"price\">售價</label>\n                    <input\n                      type=\"number\"\n                      class=\"form-control\"\n                      id=\"price\"\n                      placeholder=\"請輸入售價\"\n                      v-model=\"tempProduct.price\"\n                    />\n                  </div>\n                </div>\n                <hr />\n\n                <div class=\"form-group\">\n                  <label for=\"description\">產品描述</label>\n                  <textarea\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"description\"\n                    placeholder=\"請輸入產品描述\"\n                    v-model=\"tempProduct.discription\"\n                  ></textarea>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"content\">說明內容</label>\n                  <textarea\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"content\"\n                    placeholder=\"請輸入產品說明內容\"\n                    v-model=\"tempProduct.content\"\n                  ></textarea>\n                </div>\n                <div class=\"form-group\">\n                  <div class=\"form-check\">\n                    <input\n                      class=\"form-check-input\"\n                      type=\"checkbox\"\n                      id=\"is_enabled\"\n                      v-model=\"tempProduct.is_enabled\"\n                      :true-value=\"1\"\n                      :false-value=\"0\"\n                    />\n                    <label class=\"form-check-label\" for=\"is_enabled\">是否啟用</label>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\n            <button type=\"button\" class=\"btn btn-primary addProduct\" @click=\"updateProduct\">更新確認</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- End ProductModal -->\n\n    <!-- Start DelModal -->\n    <div\n      class=\"modal fade\"\n      id=\"delProductModal\"\n      tabindex=\"-1\"\n      role=\"dialog\"\n      aria-labelledby=\"exampleModalLabel\"\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content border-0\">\n          <div class=\"modal-header bg-orange text-white\">\n            <h5 class=\"modal-title delModalTitle\" id=\"exampleModalLabel\">\n              <span>刪除產品</span>\n            </h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <i class=\"far fa-times-circle text-white\" aria-hidden=\"true\"></i>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            是否刪除\n            <strong class=\"text-orange\">{{ tempProduct.title }}</strong> 商品(刪除後將無法恢復)。\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-orange\" @click.prevent=\"delProduct\"><i class=\"fas fa-spinner fa-spin mr-2\" v-if=\"status.loadingItem === tempProduct.id\"></i>確認刪除</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- End DelModal -->\n  </div>\n</template>\n<script>\nimport Pagination from '../../components/Pagination'\nimport $ from 'jquery'\n\nexport default {\n  name: 'products',\n  components: {\n    Pagination\n  },\n  data () {\n    return {\n      products: [],\n      pagination: {},\n      tempProduct: {},\n      isNew: false,\n      isLoading: false,\n      status: {\n        fileUploading: false,\n        loadingItem: ''\n      }\n    }\n  },\n  methods: {\n    getProducts (page = 1) {\n      const vm = this\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/products?page=${page}`\n      vm.isLoading = true\n      vm.$http.get(api).then(response => {\n        console.log(response)\n        vm.isLoading = false\n        vm.products = response.data.products\n        vm.pagination = response.data.pagination\n      })\n    },\n    openProductModal (isNew, item) {\n      const vm = this\n      if (isNew) {\n        vm.isNew = true\n        vm.tempProduct = {}\n        $('.editModalTitle').text('新增產品')\n        $('.addProduct').text('確認新增產品')\n      } else {\n        vm.isNew = false\n        vm.tempProduct = Object.assign({}, item)\n        $('.editModalTitle').text(`編輯產品: ${vm.tempProduct.title}`)\n        $('.addProduct').text('更新產品')\n      }\n      $('#productModal').modal('show')\n    },\n    updateProduct () {\n      const vm = this\n      let api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/product`\n      let httpMethod = 'post'\n      if (!vm.isNew) {\n        api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/product/${vm.tempProduct.id}`\n        httpMethod = 'put'\n      }\n      vm.$http[httpMethod](api, { data: vm.tempProduct }).then(response => {\n        if (response.data.success) {\n          $('#productModal').modal('hide')\n          vm.getProducts()\n        } else {\n          $('#productModal').modal('hide')\n          console.log('新增失敗')\n        }\n      })\n    },\n    uploadFile () {\n      const vm = this\n      const uploadedFile = this.$refs.files.files[0]\n      const formData = new FormData()\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/upload`\n      // 使用 FormData 來傳送資料到後端\n      formData.append('file-to-upload', uploadedFile)\n      vm.status.fileUploading = true\n      vm.$http.post(url, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(response => {\n        if (response.data.success) {\n          vm.status.fileUploading = false\n          // 透過 $set(寫入的目標, key值, 寫入的資料) 指令，將欄位名稱強制寫入\n          vm.$set(vm.tempProduct, 'imageUrl', response.data.imageUrl)\n        } else {\n          // 透過 $bus.$emit() 指令，跳出提示視窗\n          vm.$bus.$emit('message:push', response.data.message, 'danger')\n        }\n      })\n    },\n    delModal (item) {\n      const vm = this\n      vm.tempProduct = Object.assign({}, item)\n      $('#delProductModal').modal('show')\n    },\n    delProduct () {\n      const vm = this\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/product/${vm.tempProduct.id}`\n      vm.status.loadingItem = vm.tempProduct.id\n      vm.$http.delete(api).then(response => {\n        console.log(response)\n        $('#delProductModal').modal('hide')\n        vm.status.loadingItem = ''\n        vm.getProducts()\n      })\n    }\n  },\n  created () {\n    this.getProducts()\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\ntextarea {\n  resize : none;\n}\n</style>\n"]}]}