{"remainingRequest":"D:\\作品集\\Vue_MySweetLover\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\作品集\\Vue_MySweetLover\\src\\views\\frontEnd\\Checkout.vue?vue&type=style&index=0&id=2d91f716&lang=scss&scoped=true&","dependencies":[{"path":"D:\\作品集\\Vue_MySweetLover\\src\\views\\frontEnd\\Checkout.vue","mtime":1583915974193},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\作品集\\Vue_MySweetLover\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgIi4uLy4uL2Fzc2V0cy9hbGwuc2NzcyI7CgouY29udGFpbmVyIHsKICBwYWRkaW5nLXRvcDogOXZoOwp9Cgouc3RlcCB7CiAgd2lkdGg6IDEwMCU7CiAgcGFkZGluZzogMTBweCAwOwogIGZvbnQtc2l6ZTogMTZweDsKICBsaW5lLWhlaWdodDogMjBweDsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgY29sb3I6ICRwcmltYXJ5OwogIGJvcmRlcjogMXB4IHNvbGlkICRwcmltYXJ5OwogIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgJi5hY3RpdmUgewogICAgYmFja2dyb3VuZC1jb2xvcjogJHByaW1hcnk7CiAgICBjb2xvcjogd2hpdGU7CiAgfQp9CiNhY2NvcmRpb24gewogIHdpZHRoOiAxMDAlOwogIC5idG4tbGluaywKICAuYnRuLWxpbms6aG92ZXIgewogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogIH0KICAudG90YWxQcmljZSB7CiAgICBmb250LXdlaWdodDogYm9sZDsKICB9Cn0KdGV4dGFyZWEgewogIHJlc2l6ZTogbm9uZTsKfQo="},{"version":3,"sources":["Checkout.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyQA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Checkout.vue","sourceRoot":"src/views/frontEnd","sourcesContent":["<template>\n  <div>\n    <loading :active.sync=\"isLoading\">\n      <img src=\"../../assets/images/load.gif\" alt=\"loading\">\n    </loading>\n    <!-- Start Header -->\n    <Header />\n    <!-- End Header -->\n\n    <!-- Start Content -->\n    <div class=\"container mt-4\">\n      <div class=\"row\">\n        <div class=\"col-md-10 offset-md-1\">\n          <div class=\"row\">\n            <div class=\"col-md-4 mb-2 mb-md-4\">\n              <div class=\"step active\">資料填寫</div>\n            </div>\n            <div class=\"col-md-4 mb-2 mb-md-4\">\n              <div class=\"step\">確認訂單</div>\n            </div>\n            <div class=\"col-md-4 mb-2 mb-md-4\">\n              <div class=\"step\">完成</div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-md-6 offset-md-3\">\n          <div class=\"row mb-4\">\n            <div class=\"col-12\">\n              <div id=\"accordion\">\n                <div class=\"card\">\n                  <button\n                    class=\"card-header btn btn-link d-flex justify-content-between\"\n                    id=\"headingOne\"\n                    data-toggle=\"collapse\"\n                    data-target=\"#collapseOne\"\n                    aria-expanded=\"true\"\n                    aria-controls=\"collapseOne\"\n                  >\n                    <h5 class=\"mb-0\">購物車清單</h5>\n                    <div class=\"totalPrice\">{{ cart.final_total|currency }}</div>\n                  </button>\n                  <div\n                    id=\"collapseOne\"\n                    class=\"collapse\"\n                    aria-labelledby=\"headingOne\"\n                    data-parent=\"#accordion\"\n                  >\n                    <div class=\"card-body p-0\">\n                      <table class=\"table mb-0\">\n                        <thead>\n                          <tr>\n                            <th width=\"20%\"></th>\n                            <th class=\"text-left\">產品名稱</th>\n                            <th class=\"text-center\">單位</th>\n                            <th class=\"text-right\">價格</th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          <tr v-for=\"item in cart.carts\" :key=\"item.id\">\n                            <td>\n                              <img\n                                :src=\"`${item.product.imageUrl}`\"\n                                :alt=\"`${ item.product.title }`\"\n                                class=\"img img-fluid cartImg\"\n                              />\n                            </td>\n                            <td class=\"text-left\">\n                              {{ item.product.title }}\n                              <div class=\"text-success\" v-if=\"item.coupon\">\n                                已套用優惠券\n                              </div>\n                            </td>\n                            <td class=\"text-center\">{{ item.qty }}/{{ item.product.unit }}</td>\n                            <td class=\"text-right\">{{ item.final_total }}</td>\n                          </tr>\n                        </tbody>\n                        <tfoot>\n                          <tr>\n                            <td colspan=\"3\" class=\"text-right\">合計：</td>\n                            <td class=\"text-right\">{{ cart.total|currency }}</td>\n                          </tr>\n                          <tr v-if=\"cart.final_total !== cart.total\">\n                            <td colspan=\"3\" class=\"text-right text-success\">折扣價</td>\n                            <td class=\"text-right text-success\">{{ cart.final_total|currency }}</td>\n                          </tr>\n                        </tfoot>\n                      </table>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"input-group mt-4\">\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    placeholder=\"輸入優惠代碼\"\n                    v-model=\"coupon_code\"\n                  />\n                  <div class=\"input-group-append\">\n                    <button class=\"btn btn-outline-secondary\" type=\"button\" @click=\"addCouponCode\">輸入優惠碼</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"row mb-4\">\n            <div class=\"col-12\">\n              <form @submit.prevent=\"createOrder\">\n                <div class=\"form-group\">\n                  <label for=\"email\">Email</label>\n                  <input\n                    type=\"email\"\n                    class=\"form-control\"\n                    name=\"email\"\n                    id=\"email\"\n                    v-model=\"form.user.email\"\n                    v-validate=\"'required|email'\"\n                    placeholder=\"請輸入 Email\"\n                  />\n                  <span class=\"text-danger\" v-if=\"errors.has('email')\">{{ errors.first('email') }}</span>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"userName\">收件人姓名</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    :class=\"{'is-invalid' : errors.has('name')}\"\n                    name=\"name\"\n                    id=\"userName\"\n                    v-model=\"form.user.name\"\n                    v-validate=\"'required'\"\n                    placeholder=\"請輸入姓名\"\n                  />\n                  <span class=\"text-danger\" v-if=\"errors.has('name')\">姓名必須輸入</span>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"userTel\">收件人電話</label>\n                  <input\n                    type=\"tel\"\n                    class=\"form-control\"\n                    :class=\"{'is-invalid' : errors.has('tel')}\"\n                    name=\"tel\"\n                    id=\"userTel\"\n                    v-model=\"form.user.tel\"\n                    v-validate=\"'required'\"\n                    placeholder=\"請輸入電話\"\n                  />\n                  <span class=\"text-danger\" v-if=\"errors.has('tel')\">電話必須輸入</span>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"userAdd\">收件人地址</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    :class=\"{'is-invalid' : errors.has('address')}\"\n                    name=\"address\"\n                    id=\"userAdd\"\n                    v-model=\"form.user.address\"\n                    v-validate=\"'required'\"\n                    placeholder=\"請輸入地址\"\n                  />\n                  <span class=\"text-danger\" v-if=\"errors.has('address')\">地址欄位不得留空</span>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"comment\">留言</label>\n                  <textarea class=\"form-control\" id=\"comment\" v-model=\"form.message\" rows=\"10\"></textarea>\n                </div>\n                <div class=\"text-center\">\n                  <router-link to=\"/products\" class=\"btn btn-secondary mr-4\">繼續購物</router-link>\n                  <button type=\"submit\" class=\"btn btn-primary\">送出訂單</button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- End Content -->\n\n    <!-- Start Footer -->\n    <Footer />\n    <!-- End Footer -->\n  </div>\n</template>\n\n<script>\nimport Header from '../../components/Header'\nimport Footer from '../../components/Footer'\n\nexport default {\n  name: 'checkuot',\n  data () {\n    return {\n      cart: {},\n      isLoading: false,\n      finalTotal: 0,\n      coupon_code: '',\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: ''\n        },\n        message: ''\n      }\n    }\n  },\n  components: {\n    Header,\n    Footer\n  },\n  methods: {\n    getCart () {\n      const vm = this\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart`\n      vm.isLoading = true\n      vm.$http.get(api).then(response => {\n        vm.isLoading = false\n        console.log('response.data.data', response.data.data)\n        vm.cart = response.data.data\n        vm.finalTotal = response.data.data.final_total\n      })\n    },\n    addCouponCode () {\n      const vm = this\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/coupon`\n      const coupon = {\n        code: vm.coupon_code\n      }\n      vm.isLoading = true\n      vm.$http.post(api, { data: coupon }).then(response => {\n        console.log(response)\n        vm.getCart()\n        vm.isLoading = false\n      })\n    },\n    createOrder () {\n      const vm = this\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/order`\n      const order = vm.form\n      vm.isLoading = true\n      vm.$validator.validate().then(result => {\n        if (result) {\n          vm.$http.post(api, { data: order }).then(response => {\n            console.log('訂單已建立', response)\n            if (response.data.success) {\n              vm.$router.push(`/checkout/${response.data.orderId}`)\n            }\n            vm.isLoading = false\n          })\n        } else {\n          console.log('欄位不完整')\n        }\n      })\n    }\n  },\n  created () {\n    this.getCart()\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../../assets/all.scss\";\n\n.container {\n  padding-top: 9vh;\n}\n\n.step {\n  width: 100%;\n  padding: 10px 0;\n  font-size: 16px;\n  line-height: 20px;\n  text-align: center;\n  color: $primary;\n  border: 1px solid $primary;\n  border-radius: 20px;\n  &.active {\n    background-color: $primary;\n    color: white;\n  }\n}\n#accordion {\n  width: 100%;\n  .btn-link,\n  .btn-link:hover {\n    text-decoration: none;\n  }\n  .totalPrice {\n    font-weight: bold;\n  }\n}\ntextarea {\n  resize: none;\n}\n</style>\n"]}]}